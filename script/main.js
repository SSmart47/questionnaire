var questions=[],indexes=[],last_variant=-1;function Exist(e,n){for(var t=0;t<e.length;t++)if(e[t]==n)return!0;return!1}function ArrayRemoveIndex(e,n){for(var t=[],a=0;a<e.length;a++)a!=n&&t.push(e[a]);return t}function StrToHTML(e){e=""+e;return e=(e=e.replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll("\n","<br>")).replaceAll("\t","&nbsp;&nbsp;&nbsp;&nbsp;").replaceAll("  ","&nbsp; ").replaceAll("  "," &nbsp;")}function Random(e){var n=Math.random();return n*=Math.pow(10,(""+parseInt(e)).length+1),parseInt(n)%parseInt(e)}function GetVarname(e){e=questions[parseInt(e)].split("\n")[0].split(" ");return StrToHTML(e[e.length-1])}function FixedQuestion(e){for(var n=(""+e).split("<br>"),t=1;t<n.length;t++){var a=Exist(a=""+n[t]," ")?"<b>"+a.replace(" ","</b> "):"<b>"+a+"</b>";n[t]=""+a}for(var r=""+n[0],t=1;t<n.length;t++)r+="<br>"+n[t];return r}function UpdateVariantsDropdown(){for(var e="",n=1;n<=questions.length;n++){var t="red";Exist(indexes,n)&&(t="green"),e+='<a class="dropdown-item" href="#" style="color: '+t+';" data-toggle="modal" data-target="#ModalShowVariant" onclick="PressedVariant('+n+')"><b>'+GetVarname(n-1)+"</b></a>"}document.getElementById("variants_list").innerHTML=e}function RefreshIndexes(){document.getElementById("current_question").innerHTML="",indexes=[];for(var e=1;e<=questions.length;e++)indexes.push(e);UpdateVariantsDropdown()}function GetRandomVariant(){var e,n;0!=indexes.length?(e=Random(indexes.length),n=indexes[e],indexes=ArrayRemoveIndex(indexes,e),UpdateVariantsDropdown(),document.getElementById("current_question").innerHTML=FixedQuestion(StrToHTML(questions[n-1]))):alert("Вариантхо ба итмом расидаанд")}function PressedVariant(e){document.getElementById("modal_var_body").innerHTML=FixedQuestion(StrToHTML(questions[e-1])),last_variant=parseInt(e),Exist(indexes,last_variant)?document.getElementById("modal_var_buttons").innerHTML='<button type="button" class="btn btn-danger" data-dismiss="modal" onclick="RemoveSelectedVariant()">Хорич</button><button type="button" class="btn btn-secondary" data-dismiss="modal">Ба кафо</button>':document.getElementById("modal_var_buttons").innerHTML='<button type="button" class="btn btn-success" data-dismiss="modal" onclick="AddSelectedVariant()">Ворид</button><button type="button" class="btn btn-secondary" data-dismiss="modal">Ба кафо</button>'}function AddSelectedVariant(){indexes.push(last_variant),UpdateVariantsDropdown()}function RemoveSelectedVariant(){for(var e=indexes.length-1;0<=e;e--)indexes[e]==last_variant&&(indexes=ArrayRemoveIndex(indexes,e));UpdateVariantsDropdown()}async function TestFileUpdate(){var e=document.getElementById("question_file").files[0];let t=new FileReader;t.readAsText(e),t.onload=function(){text=t.result;for(var e=text.split("\n"),n=e.length-1;0<=n;n--)""==e[n].trim()&&(e=ArrayRemoveIndex(e,n));questions=[];for(n=3;n<e.length;n+=4)questions.push(e[n-3]+"\n"+e[n-2]+"\n"+e[n-1]+"\n"+e[n]);RefreshIndexes()},t.onerror=function(){console.log(t.error)}}